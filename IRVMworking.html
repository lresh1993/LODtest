<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<title>LOD IRVM Working Map</title>

<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'/>

<!-- Start Mobile Optimization -->
<meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<!-- End Mobile Optimization -->

	
<!-- *******************DO NOT REMOVE***************** -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="crossorigin=""></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet-easybutton@2.0.0/src/easy-button.css">
<script src="https://unpkg.com/leaflet-easybutton@2.0.0/src/easy-button.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- *******************DO NOT REMOVE***************** -->


<!-- Start CSS Data Load -->
  
<link rel="stylesheet" href="css/Leaflet.Coordinates-0.1.5.css"/>
<link rel="stylesheet" href="css/L.Control.Locate.css"/>
<link rel="stylesheet" href="css/Leaflet.NavBar.css"/>
<link rel="stylesheet" href="css/Control.MiniMap.css"/>
<link rel="stylesheet" href="css/Control.OSMGeocoder.css"/>
<link rel="stylesheet" href="css/esri-leaflet-geocoder.css"/>
<link rel="stylesheet" href="css/gh-fork-ribbon.ie.css"/>
<link rel="stylesheet" href="css/gh-fork-ribbon.css"/>
<link rel="stylesheet" href="css/leaflet-control-credits.css" />
<link rel="stylesheet" href="css/styledLayerControl.css" />
<link rel="stylesheet" href="css/leaflet-measure.css" />
<link rel="stylesheet" href="css/leaflet.bookmarks.min.css" />
<link rel="stylesheet" href="css/leaflet.bookmarks.css" />
<link rel="stylesheet" href="css/Control.Geocoder.css" />
<link rel="stylesheet" href="css/leaflet.draw.css" />
<link rel="stylesheet" href="css/L.VisualClick.css" />
<link rel="stylesheet" href="css/easy-button.css" />
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">


<!-- End CSS Data Load -->


<!-- Start Scripts Data Load -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/leaflet/1.0.0-rc.1/leaflet-src.js"></script>
<script src="https://cdn.jsdelivr.net/leaflet.esri/2.0.0/esri-leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/leaflet.esri.gp/2.0.0/esri-leaflet-gp.js"></script>
<script src="https://cdn.jsdelivr.net/leaflet.esri.geocoder/2.0.2/esri-leaflet-geocoder.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script type="text/javascript" src="scripts/L.Control.Locate.js"></script>
<script type="text/javascript" src="scripts/TileLayer.WMTS.js"></script>
<script type="text/javascript" src="scripts/leaflet-tilelayer-wmts.js"></script>
<script type="text/javascript" src="scripts/Leaflet.Coordinates-0.1.5.js"></script>
<script type="text/javascript" src="scripts/Leaflet.NavBar.js"></script>
<script type="text/javascript" src="scripts/Control.MiniMap.js"></script>
<script type="text/javascript" src="scripts/Control.OSMGeocoder.js"></script>
<script type="text/javascript" src="scripts/catiline.js"></script>
<script type="text/javascript" src="scripts/catiline.js"></script> 
<script type="text/javascript" src="scripts/leaflet.fgdb.js"></script> 
<script type="text/javascript" src="scripts/leaflet-control-credits.js"></script>
<script type="text/javascript" src="scripts/styledLayerControl.js"></script>
<script type="text/javascript" src="scripts/leaflet-measure.min.js"></script>
<script type="text/javascript" src="scripts/Control.Draw.js"></script>
<script type="text/javascript" src="scripts/leaflet.filelayer.js"></script>
<script type="text/javascript" src="scripts/Leaflet.Bookmarks.js"></script>
<script type="text/javascript" src="scripts/Leaflet.Bookmarks.min.js"></script>
<script type="text/javascript" src="scripts/Control.Geocoder.js"></script>
<script type="text/javascript" src="scripts/leaflet.browser.print.min.js"></script>
<script type="text/javascript" src="scripts/leaflet.browser.print.js"></script>
<script type="text/javascript" src="scripts/leaflet.browser.print.utils.js"></script>
<script type="text/javascript" src="scripts/Leaflet.draw.js"></script>
<script type="text/javascript" src="scripts/Leaflet.Draw.Event.js"></script>
<script type="text/javascript" src="scripts/Toolbar.js"></script>
<script type="text/javascript" src="scripts/Tooltip.js"></script>
<script type="text/javascript" src="scripts/GeometryUtil.js"></script>
<script type="text/javascript" src="scripts/LatLngUtil.js"></script>
<script type="text/javascript" src="scripts/LineUtil.Intersect.js"></script>
<script type="text/javascript" src="scripts/Polygon.Intersect.js"></script>
<script type="text/javascript" src="scripts/Polyline.Intersect.js"></script>
<script type="text/javascript" src="scripts/TouchEvents.js"></script>
<script type="text/javascript" src="scripts/DrawToolbar.js"></script>
<script type="text/javascript" src="scripts/Draw.Feature.js"></script>
<script type="text/javascript" src="scripts/Draw.SimpleShape.js"></script>
<script type="text/javascript" src="scripts/Draw.Polyline.js"></script>
<script type="text/javascript" src="scripts/Draw.Marker.js"></script>
<script type="text/javascript" src="scripts/Draw.Circle.js"></script>
<script type="text/javascript" src="scripts/Draw.CircleMarker.js"></script>
<script type="text/javascript" src="scripts/Draw.Polygon.js"></script>
<script type="text/javascript" src="scripts/Draw.Rectangle.js"></script>
<script type="text/javascript" src="scripts/EditToolbar.js"></script>
<script type="text/javascript" src="scripts/EditToolbar.Edit.js"></script>
<script type="text/javascript" src="scripts/EditToolbar.Delete.js"></script>
<script type="text/javascript" src="scripts/Control.Draw.js"></script>
<script type="text/javascript" src="scripts/Edit.Poly.js"></script>
<script type="text/javascript" src="scripts/Edit.SimpleShape.js"></script>
<script type="text/javascript" src="scripts/Edit.Rectangle.js"></script>
<script type="text/javascript" src="scripts/Edit.Marker.js"></script>
<script type="text/javascript" src="scripts/Edit.CircleMarker.js"></script>
<script type="text/javascript" src="scripts/Edit.Circle.js"></script>
<script type="text/javascript" src="scripts/L.VisualClick.js"></script>
<script type="text/javascript" src="scripts/easy-button.js"></script>
<script type="text/javascript" src="scripts/d3.v3.min.js"></script>
<script type="text/javascript" src="scripts/metatable.js"></script>

<!-- End Scripts Data Load -->


<!-- Start GeoJSON Data Load -->

<script type="text/javascript" src="data/ProjectLimits/BA711.txt"></script>
<script type="text/javascript" src="data/ProjectLimits/AA174.txt"></script>
<script type="text/javascript" src="data/ProjectLimits/BA637.txt"></script>
<script type="text/javascript" src="data/ProjectLimits/HO245.txt"></script>
<script type="text/javascript" src="data/ProjectLimits/MO384.txt"></script>
<script type="text/javascript" src="data/ProjectLimits/PG402.txt"></script>
<script type="text/javascript" src="data/ProjectLimits/WA255.txt"></script>
<script type="text/javascript" src="data/Extra/maryland.txt"></script>
<script type="text/javascript" src="data/Extra/DNR_Critical.txt"></script>
<script type="text/javascript" src="data/Extra/SHAfacilities.txt"></script>

<!-- End GeoJSON Data Load -->

	<style>
	
        body {
            margin: 0;
            padding: 0;
        }
        #map {
            position: absolute;
            top: 6.5%;
            bottom: 0;
            width: 100%;
			z-index: 0;
        }
        #export {
			position: absolute;
            background-color: #ff0000;
			border: none;
			color: white;
			padding: 13px 40px;
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 16px;
			top:0.5%;
			right:4.5px;
			z-index: 2;
        }
		.myButton {
			-moz-box-shadow:inset 0px 1px 0px 0px #9acc85;
			-webkit-box-shadow:inset 0px 1px 0px 0px #9acc85;
			box-shadow:inset 0px 1px 0px 0px #9acc85;
			background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #74ad5a), color-stop(1, #68a54b));
			background:-moz-linear-gradient(top, #74ad5a 5%, #68a54b 100%);
			background:-webkit-linear-gradient(top, #74ad5a 5%, #68a54b 100%);
			background:-o-linear-gradient(top, #74ad5a 5%, #68a54b 100%);
			background:-ms-linear-gradient(top, #74ad5a 5%, #68a54b 100%);
			background:linear-gradient(to bottom, #74ad5a 5%, #68a54b 100%);
			filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#74ad5a', endColorstr='#68a54b',GradientType=0);
			background-color:#74ad5a;
			border:1px solid #3b6e22;
			display:inline-block;
			cursor:pointer;
			color:#ffffff;
			font-family:Arial;
			font-size:13px;
			font-weight:bold;
			padding:10px 12px;
			text-decoration:none;
		}
		.myButton:hover {
			background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #68a54b), color-stop(1, #74ad5a));
			background:-moz-linear-gradient(top, #68a54b 5%, #74ad5a 100%);
			background:-webkit-linear-gradient(top, #68a54b 5%, #74ad5a 100%);
			background:-o-linear-gradient(top, #68a54b 5%, #74ad5a 100%);
			background:-ms-linear-gradient(top, #68a54b 5%, #74ad5a 100%);
			background:linear-gradient(to bottom, #68a54b 5%, #74ad5a 100%);
			filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#68a54b', endColorstr='#74ad5a',GradientType=0);
			background-color:#68a54b;
		}
		.myButton:active {
			position:relative;
			top:1px;
		}
		body {margin:0;}

		.topnav {
			position: fixed;
			left: 0px;
			right: 0px;
			overflow: hidden;
			background-color: #333;
			border: 2.5px solid gray;
			z-index: 1;
		}

		.topnav a {
			float: left;
			display: block;
			color: #f2f2f2;
			text-align: center;
			padding: 14px 16px;
			text-decoration: none;
			font-size: 17px;
		}

		.topnav a:hover {
			background-color: #ddd;
			color: black;
		}

		.topnav a.active {
			background-color: #4CAF50;
			color: white;
		}
		.info {
			background-color:#ffffff;
			-moz-border-radius:34px;
			-webkit-border-radius:34px;
			border-radius:34px;
			border:3px solid #adadad;
			display:inline-block;
			cursor:pointer;
			color:#000000;
			font-family:Times New Roman;
			font-size:20px;
			font-style:italic;
			padding:8px 16px;
			text-decoration:none;
			text-shadow:0px 0px 0px #0e3309;
		}
		.info:hover {
			background-color:#ffffff;
		}
		.info:active {
			position:relative;
			top:0px;
		}

		#help {
			position: absolute;
            background-color: white;
			border:2px solid gray;
			color: black;
			padding: 3px 15px;
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 16px;
			top: 1.5%;
			right: 215px;
			z-index: 2;
        }
		/* The Modal (background) */
		.modal {
			display: none; /* Hidden by default */
			position: fixed; /* Stay in place */
			z-index: 1; /* Sit on top */
			padding-top: 100px; /* Location of the box */
			left: 0;
			top: 0;
			width: 100%; /* Full width */
			height: 100%; /* Full height */
			overflow: auto; /* Enable scroll if needed */
			background-color: rgb(0,0,0); /* Fallback color */
			background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
		}

		/* Modal Content */
		.modal-content {
			position: relative;
			background-color: #fefefe;
			margin: auto;
			padding: 0;
			border: 1px solid #888;
			width: 80%;
			box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
			-webkit-animation-name: animatetop;
			-webkit-animation-duration: 0.4s;
			animation-name: animatetop;
			animation-duration: 0.4s
		}

		/* Add Animation */
		@-webkit-keyframes animatetop {
			from {top:-300px; opacity:0} 
			to {top:0; opacity:1}
		}

		@keyframes animatetop {
			from {top:-300px; opacity:0}
			to {top:0; opacity:1}
		}

		/* The Close Button */
		.close {
			color: white;
			float: right;
			font-size: 28px;
			font-weight: bold;
		}

		.close:hover,
		.close:focus {
			color: #000;
			text-decoration: none;
			cursor: pointer;
		}

		.modal-header {
			padding: 2px 16px;
			background-color: #5cb85c;
			color: white;
		}

		.modal-body {padding: 2px 16px;}

	</style>
</head>

<body>

<div id='map'></div>
<a href='#' class="myButton" id='export'>Export Features</a>
<a href="#" class="info" id='help'>i</a>
<div class="topnav" id="myTopnav">
<a href="http://shaintranet/oed/default.aspx">Landscape Operations IRVM Web Application</a>
</div>
<div id="myModal" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
    <div class="modal-header">
      <span class="close">&times;</span>
      <h2><b>Exporting Features</b></h2>
    </div>
    <div class="modal-body">
      <p>This web application exports drawn features in a geojson format. Future updates will hopefully allow downloads into other data types. <b>***</b>Note that features created using the measuring tool will not be extracted from export.<b>***</b></p>
      <p style="font-size:150%;">In order to convert .json files to .KMZ files, use <a href="http://geojson.io/#map=2/20.0/0.0">GeoJson.io</a>.</p>
    </div>
   </div>

<script>

// initialize map
var map = L.map('map').setView([39.306675, -76.621742], 12);
		map.options.minZoom = 8;
		map.options.maxZoom = 20;

// ***********************************************************BASEMAPS **********************************************************************

// Openstreet
var OpenStreetMap_Mapnik = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
	maxZoom: 19,
	attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
}).addTo(map);

//Mapbox
var Map_Box = new L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
  id: 'mapbox.streets'
 });
 
// Mapbox Satellite
var MapboxSatellite = new L.tileLayer ('https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v10/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoibHJlc2giLCJhIjoiY2ludXI3MmV5MTI0N3VnbHkycnpnenowNCJ9.VyMIrAJAszJ5wYecIHkwbg', {
  id: 'mapbox.sate'
 });
 
 
 //Google Maps
var Google = new L.tileLayer('http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}', {
            attribution: 'google'
        });
 
 
//	Esri - World Imagery
var Esri_WorldImagery = new L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	format: 'image/png',
	minZoom: 2,
	maxZoom: 19,
	opacity: 1,
	attribution: 'Tiles &copy; <a href="http://www.esri.com">Esri</a> &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, and others'
});

// Open Topo Map
var OpenTopoMap = L.tileLayer('http://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
	maxZoom: 17,
	attribution: 'Map data: &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'
});


//  OpenWeatherMap - Temperature refer to http://openweathermap.org/map_legend for color codes
var temperature = new L.tileLayer('http://{s}.tile.openweathermap.org/map/temp/{z}/{x}/{y}.png', {
	format: 'image/png',
	minZoom: 2,
	maxZoom: 19,
	opacity: 0.5,
	attribution: 'Map data &copy; <a href="http://openweathermap.org">OpenWeatherMap</a>'
});

// The National Map (Interstate and US)
var majorroads = new L.TileLayer.WMS('http://services.nationalmap.gov/arcgis/services/transportation/MapServer/WMSServer', {
	format: 'image/png',
	layers: '6,7,15,16',
	minZoom: 3,
	maxZoom: 16,
	opacity: 1,
	transparent: true,
	zIndex: 1000,
	attribution: 'Map tiles courtesy of <a href="http://viewer.nationalmap.gov/services/" target="_blank">US Geological Survey</a>'
	});

	
// National Land Cover Database (NLCD)
var landcover = new L.TileLayer.WMS('http://raster.nationalmap.gov/arcgis/services/LandCover/USGS_EROS_LandCover_NLCD/MapServer/WmsServer?"/>', {
	format: 'image/png',
	layers: '6,7,15,16',
	minZoom: 3,
	maxZoom: 16,
	opacity: 1,
	transparent: true,
	zIndex: 1000,
	attribution: 'Map tiles courtesy of <a href="http://viewer.nationalmap.gov/services/" target="_blank">US Geological Survey</a>'
	});
	
// OpenMapSurfer
var OpenMapSurfer_Roads = L.tileLayer('http://korona.geog.uni-heidelberg.de/tiles/roads/x={x}&y={y}&z={z}', {
	maxZoom: 20,
	attribution: 'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
});

//Open black and white
var OpenStreetMap_BlackAndWhite = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
	maxZoom: 18,
	attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
});

	
// **********************************************************OVERLAY LAYERS***********************************************************************
var maryland = new L.LayerGroup();

	L.geoJson(marylandStateBoundary, {
		style: function (feature) {
			return {
			"color": "#0074FF",
			"weight": 5
		}
	  },
	  onEachFeature: function(feature, layer) {
		layer.bindPopup("<b>County: </b>" + feature.properties.COUNTY + "<br>" + "<b>District: </b>" + feature.properties.DISTRICT);
	  } 
}).addTo(maryland)	


// SHA Facilities
var maintIcon = L.icon({
		iconUrl: 'images/SHA/Maint.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});
		
var testIcon = L.icon({
		iconUrl: 'images/SHA/Headquarters.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});
var restIcon = L.icon({
		iconUrl: 'images/SHA/Rest.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});
		
var weightIcon = L.icon({
		iconUrl: 'images/SHA/Weight.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});	
var bridgeIcon = L.icon({
		iconUrl: 'images/SHA/Bridge.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});
		
var commIcon = L.icon({
		iconUrl: 'images/SHA/Communications.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});
var labIcon = L.icon({
		iconUrl: 'images/SHA/Lab.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});
		
var saltIcon = L.icon({
		iconUrl: 'images/SHA/Salt.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});	
var sateIcon = L.icon({
		iconUrl: 'images/SHA/Sate.png',
		shadowUrl: 'images/markers/shadow.png',
		iconSize: [30, 30],
		iconAnchor: [12, 28],
		popupAnchor: [0, -25],
		labelAnchor: [6, -12]
		});	
		
		
	var buildings = new L.LayerGroup();

      L.geoJson(facilities, {
        pointToLayer: function (feature, latlng) {
		if (feature.properties.FAC_TYPE == "Maintenance")
          return L.marker(latlng, {
            icon: maintIcon
		});
		else if (feature.properties.FAC_TYPE == "Administrative")
			return L.marker(latlng, {
			icon: testIcon
		});
		else if (feature.properties.FAC_TYPE == "Rest Area")
			return L.marker(latlng, {
			icon: restIcon
		});
		else if (feature.properties.FAC_TYPE == "Communcations")
			return L.marker(latlng, {
			icon: commIcon
		});
		else if (feature.properties.FAC_TYPE == "Laboratory")
			return L.marker(latlng, {
			icon: labIcon
		});
		else if (feature.properties.FAC_TYPE == "Movable Bridge")
			return L.marker(latlng, {
			icon: bridgeIcon
		});
		else if (feature.properties.FAC_TYPE == "Salt Storage")
			return L.marker(latlng, {
			icon: saltIcon
		});
		else if (feature.properties.FAC_TYPE == "Satellite")
			return L.marker(latlng, {
			icon: sateIcon
		});
		else if (feature.properties.FAC_TYPE == "Weigh Station")
			return L.marker(latlng, {
			icon: weightIcon
		});
        },
		onEachFeature: function (feature, layer) {
          if (feature.properties) {
			var content = '<p><b>' + feature.properties.FACILITY + '</b></p>' + 
				'<p><b>' + feature.properties.FAC_TYPE + '</b></p>';
			layer.bindPopup(content);
			}
		}
	}).addTo(buildings)

//var critical = new L.LayerGroup();

//L.geoJson(criticalareas, {
//   style: function (feature) {
//       return {
//         stroke: true,
//         color: "yellow", 
//         weight: 5};
//   },
//   onEachFeature: function (feature, layer) {
//       layer.bindPopup("Type: " + feature.properties.Type +"<br>"+
//                        "Location: " + feature.properties.Location +"<br>"+ "WebLink: " + feature.properties.WebLink +"<br>"+
//                        "CritArea: " + feature.properties.CritArea); 
//   }
//}).addTo(critical);

var limits1 = new L.LayerGroup();

L.geoJson(AAprojectlimits, {
   style: function (feature) {
       return {
         stroke: true,
         color: "red", 
         weight: 5};
   },
   onEachFeature: function (feature, layer) {
       layer.bindPopup("<b>Contract Number: </b>" + feature.properties.Contract_N + "<br>" + "<b>District: </b>" + feature.properties.District + "<br>" +
                        "<b>Project Value: </b>" + feature.properties.Project_Value + "<br>" + "<b>County: </b>" + feature.properties.County + "<br>" + "<b>Status: </b>" + feature.properties.Status + "<br>"+
						"<b>AD Date: </b>" + feature.properties.AD_DATE + "<br>" + "<b>Limits: </b>" + feature.properties.Limits + "<br>" + "<b>Duration: </b>" + feature.properties.Duration); 
   }
}).addTo(limits1);

var limits2 = new L.LayerGroup();

L.geoJson(BA637projectlimits, {
   style: function (feature) {
       return {
         stroke: true,
         color: "black", 
         weight: 5};
   },
   onEachFeature: function (feature, layer) {
       layer.bindPopup("<b>Contract Number: </b>" + feature.properties.Contract_N + "<br>" + "<b>District: </b>" + feature.properties.District + "<br>" +
                        "<b>Project Value: </b>" + feature.properties.Project_Value + "<br>" + "<b>County: </b>" + feature.properties.County + "<br>" + "<b>Status: </b>" + feature.properties.Status + "<br>"+
						"<b>AD Date: </b>" + feature.properties.AD_DATE + "<br>" + "<b>Limits: </b>" + feature.properties.Limits + "<br>" + "<b>Duration: </b>" + feature.properties.Duration); 
   }
}).addTo(limits2);

var limits3 = new L.LayerGroup();

L.geoJson(projectlimits, {
   style: function (feature) {
       return {
         stroke: true,
         color: "purple", 
         weight: 5};
   },
   onEachFeature: function (feature, layer) {
       layer.bindPopup("<b>Contract Number: </b>" + feature.properties.Contract_N + "<br>" + "<b>District: </b>" + feature.properties.District + "<br>" +
                        "<b>Project Value: </b>" + feature.properties.Project_Value + "<br>" + "<b>County: </b>" + feature.properties.County + "<br>" + "<b>Status: </b>" + feature.properties.Status + "<br>"+
						"<b>AD Date: </b>" + feature.properties.AD_DATE + "<br>" + "<b>Limits: </b>" + feature.properties.Limits + "<br>" + "<b>Duration: </b>" + feature.properties.Duration); 
   }
}).addTo(limits3);

var limits4 = new L.LayerGroup();

L.geoJson(HO245projectlimits, {
   style: function (feature) {
       return {
         stroke: true,
         color: "blue", 
         weight: 5};
   },
   onEachFeature: function (feature, layer) {
       layer.bindPopup("<b>Contract Number: </b>" + feature.properties.Contract_N + "<br>" + "<b>District: </b>" + feature.properties.District + "<br>" +
                        "<b>Project Value: </b>" + feature.properties.Project_Value + "<br>" + "<b>County: </b>" + feature.properties.County + "<br>" + "<b>Status: </b>" + feature.properties.Status + "<br>"+
						"<b>AD Date: </b>" + feature.properties.AD_DATE + "<br>" + "<b>Limits: </b>" + feature.properties.Limits + "<br>" + "<b>Duration: </b>" + feature.properties.Duration); 
   }
}).addTo(limits4);

var limits5 = new L.LayerGroup();

L.geoJson(MO384projectlimits, {
   style: function (feature) {
       return {
         stroke: true,
         color: "orange", 
         weight: 5};
   },
   onEachFeature: function (feature, layer) {
       layer.bindPopup("<b>Contract Number: </b>" + feature.properties.Contract_N + "<br>" + "<b>District: </b>" + feature.properties.District + "<br>" +
                        "<b>Project Value: </b>" + feature.properties.Project_Value + "<br>" + "<b>County: </b>" + feature.properties.County + "<br>" + "<b>Status: </b>" + feature.properties.Status + "<br>"+
						"<b>AD Date: </b>" + feature.properties.AD_DATE + "<br>" + "<b>Limits: </b>" + feature.properties.Limits + "<br>" + "<b>Duration: </b>" + feature.properties.Duration); 
   }
}).addTo(limits5);

var limits6 = new L.LayerGroup();

L.geoJson(PG402projectlimits, {
   style: function (feature) {
       return {
         stroke: true,
         color: "yellow", 
         weight: 5};
   },
   onEachFeature: function (feature, layer) {
       layer.bindPopup("<b>Contract Number: </b>" + feature.properties.Contract_N + "<br>" + "<b>District: </b>" + feature.properties.District + "<br>" +
                        "<b>Project Value: </b>" + feature.properties.Project_Value + "<br>" + "<b>County: </b>" + feature.properties.County + "<br>" + "<b>Status: </b>" + feature.properties.Status + "<br>"+
						"<b>AD Date: </b>" + feature.properties.AD_DATE + "<br>" + "<b>Limits: </b>" + feature.properties.Limits + "<br>" + "<b>Duration: </b>" + feature.properties.Duration); 
   }
}).addTo(limits6);

var limits7 = new L.LayerGroup();

L.geoJson(WA255projectlimits, {
   style: function (feature) {
       return {
         stroke: true,
         color: "green", 
         weight: 5};
   },
   onEachFeature: function (feature, layer) {
       layer.bindPopup("<b>Contract Number: </b>" + feature.properties.Contract_N + "<br>" + "<b>District: </b>" + feature.properties.District + "<br>" +
                        "<b>Project Value: </b>" + feature.properties.Project_Value + "<br>" + "<b>County: </b>" + feature.properties.County + "<br>" + "<b>Status: </b>" + feature.properties.Status + "<br>"+
						"<b>AD Date: </b>" + feature.properties.AD_DATE + "<br>" + "<b>Limits: </b>" + feature.properties.Limits + "<br>" + "<b>Duration: </b>" + feature.properties.Duration); 
   }
}).addTo(limits7);
	
//***************************************************LAYER CONTROL BOX***********************************************************************************	
//  Basemaps
	var baseMaps = [
					{
						groupName : "Basemaps",
						expanded : true,
						layers	:{
							"OpenStreet": OpenStreetMap_Mapnik,
							"OpenStreet Surfer": OpenMapSurfer_Roads,
							"Google Maps": Google,
							"Mapbox Streets": Map_Box,
							"Mapbox Satellite": MapboxSatellite,
							"Esri World Imagery": Esri_WorldImagery,
							"OpenStreet Black and White": OpenStreetMap_BlackAndWhite,
							"Topography Map": OpenTopoMap
							}
						}
	];

//  Overlay Maps
	var overlayMaps = [
						{	
							groupName: "Project Limits",
							expanded : false,
							layers   : {
//Project Limits
								"AA174": limits1,
								"BA637": limits2,
								"BA711": limits3,
								"HO245": limits4,
								"MO384": limits5,
								"PG402": limits6,
								"WA255": limits7								
							}
						},	{
//							groupName: "Completed Projects",
//							expanded : false,
//							layers   : {
//Completed
//								"AT0625124": completed1,
//								"AT0645124": completed2,
//								"AT0825124": completed3,
//								"AT0835124": completed4,
//								"AX0705124": completed5,
//								"AX0715124": completed6,
//								"AX0725124": completed7,
//								"AX0795124SBR": completed8,
//								"AX6205124": completed9,
//								"PG7455168": completed10,
//								"WI2305124": completed11
//							}
//						},	{
//							groupName: "Active Projects",
//							expanded : false,
//							layers   : {
//Active
//								"AA1745124": active1,
//								"AT0615124": active2,
//								"AX0076114": active3,
//								"AX0805124": active4,
//								"BA7115224": active5,
//								"MO3845224": active6,
//								"PG9595124": active7
//							}
//						},	{
//							groupName: "In-Design Projects",
//							expanded : false,
//							layers   : {
//In-Design
//								"AA1755124": design1,
//								"BA4475124": design2,
//								"BA6375324": design3,
//								"HO2455124": design4,
//								"MO6455224": design5,
//								"PG4025324": design6,
//								"PG4045224": design7,
//								"PG4045324": design8,
//								"WA2555124": design9,
//								"WA2595124": design10
//							}
//						},	{
							groupName:	"Extra",
							expanded :	false,
							layers   :	{
//Add-Ons
//								"OpenWeatherMap Temperature": temperature,
//								"Major Roads": majorroads,
								"Maryland County Boundaries": maryland,
//								"DNR Critical Areas": critical,
								"SHA Facilities": buildings,
								"National Land Cover(2015)": landcover,
//								"Traffic Barriers": barriers
							}
						}
	];

	
//------------------------------------------------------------START MAP FUNCTIONS,TOOLS,& CONTROLS------------------------------------------------------------------------------------------

//  Layer Control
var control = L.Control.styledLayerControl(baseMaps, overlayMaps);
    map.addControl(control);


//Leaflet Navigation Bar ()
	L.control.navbar().addTo(map);


// Display Scale Control
var scaleControl = new L.control.scale({
	position: 'bottomleft'
	});


// Mini Map
	var osm2 = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {minZoom: 0, maxZoom: 13, attribution: 'Map data &copy; OpenStreetMap contributors'});
	var miniMap = new L.Control.MiniMap(osm2).addTo(map);
	

// Print toolbar
L.browserPrint().addTo(map)

	
// Display mouse coordinates
var mouseControl = new L.control.coordinates({
	position:"bottomleft",
	decimals:6,
	decimalSeperator:",",
	labelTemplateLat:"Latitude: {y}",
	labelTemplateLng:"Longitude: {x}"
    });

	map.addControl(mouseControl);
	map.addControl(scaleControl);

	
//Credits
var credctrl = L.controlCredits({
	position: "bottomleft",
    image: "images/markers/sha.png",
    link: "http://www.roads.maryland.gov/Index.aspx?PageId=114",
    text: "Interactive Mapping<br/>by Luis Resh"
}).addTo(map);


//Geocoder
L.Control.geocoder({
	position: "topleft"
}).addTo(map);


//Measuring Tool	
var measureControl = new L.Control.Measure(options);
measureControl.addTo(map);


//Bookmark Toolbar
var control = new L.Control.Bookmarks().addTo(map);





//    drawnItems = L.featureGroup().addTo(map);
			
//    map.addControl(new L.Control.Draw({
//        edit: {
//            featureGroup: drawnItems,
//            poly: {
//                allowIntersection: false
//            }
//        },
//        draw: {
//            polygon: {
//                allowIntersection: false,
//                showArea: true
//            }
//        }
//    }));

//    map.on(L.Draw.Event.CREATED, function (event) {
//        var layer = event.layer;

//        drawnItems.addLayer(layer);
//    });

var featureGroup = L.featureGroup().addTo(map);

        var drawControl = new L.Control.Draw({
            edit: {
                featureGroup: featureGroup
            }
        }).addTo(map);

        map.on('draw:created', function(e) {

            // Each time a feaute is created, it's added to the over arching feature group
            featureGroup.addLayer(e.layer);
        });	
	
document.getElementById('export').onclick = function(e) {
            // Extract GeoJson from featureGroup
            var data = featureGroup.toGeoJSON();

            // Stringify the GeoJson
            var convertedData = 'text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(data));
			
			// then export to kml
			var kml = tokml(convertedData);		

            // Create export
            document.getElementById('export').setAttribute('href', 'data:' + convertedData);
            document.getElementById('export').setAttribute('download','data.json');
			
		
        }

		

		


//----------------------------------------------------------END MAP FUNCTIONS,TOOLS,& CONTROLS----------------------------------------------------------------------------------	




//TESTING********************************************************************************************************



var popup = L.popup()
    .setLatLng([39.323438, -76.609383])
    .setContent('<b>Change and add layers using the tool<center>in top right corner.</center></b>')
    .openOn(map);

	
// Get the modal
var modal = document.getElementById('myModal');

// Get the button that opens the modal
var btn = document.getElementById("help");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on the button, open the modal 
btn.onclick = function() {
    modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}	
	
	
	




</script>

</body>

</html>
